{%- comment -%} Blog + BlogPosting JSON-LD Schema {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": {{ blog.title | json }},
  "url": "{{ shop.url }}{{ blog.url }}",
  "description": {{ blog.title | json }},
  "publisher": {
    "@type": "Organization",
    "name": {{ shop.name | json }},
    "url": "{{ shop.url }}"
    {%- if shop.brand.logo -%}
    ,"logo": {
      "@type": "ImageObject",
      "url": "{{ shop.brand.logo | image_url: width: 600 }}"
    }
    {%- endif -%}
  },
  "blogPost": [
    {%- for article in blog.articles -%}
    {
      "@type": "BlogPosting",
      "headline": {{ article.title | json }},
      "url": "{{ shop.url }}{{ article.url }}",
      "datePublished": "{{ article.published_at | date: '%Y-%m-%dT%H:%M:%S%z' }}",
      "dateModified": "{{ article.updated_at | date: '%Y-%m-%dT%H:%M:%S%z' }}",
      "author": {
        "@type": "Person",
        "name": {{ article.author | json }}
      },
      "description": {{ article.excerpt_or_content | strip_html | truncate: 200 | json }}
      {%- if article.image -%}
      ,"image": {
        "@type": "ImageObject",
        "url": "{{ article.image | image_url: width: 1200 }}",
        "width": {{ article.image.width }},
        "height": {{ article.image.height }}
      }
      {%- endif -%}
    }{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ]
}
</script>

<script
  src="{{ 'blog-posts-list.js' | asset_url }}"
  type="module"
  fetchpriority="low"
></script>

<blog-posts-list section-id="{{ section.id }}">
  <div class="section-background color-{{ section.settings.color_scheme }}"></div>

  {%- if section.settings.show_hero -%}
    <div class="blog-hero" style="--hero-bg-color: {{ section.settings.hero_bg_color }}; --hero-text-color: {{ section.settings.hero_text_color }}; --hero-min-height: {{ section.settings.hero_height }}px;">
      {%- if section.settings.hero_image != blank -%}
        {{ section.settings.hero_image | image_url: width: 2000 | image_tag: class: 'blog-hero__image', loading: 'lazy' }}
      {%- endif -%}
      <div class="blog-hero__content page-width">
        <h1 class="blog-hero__title">
          <span class="blog-hero__title-main">{{ section.settings.hero_text_1 }}</span>
          <span class="blog-hero__title-italic">{{ section.settings.hero_text_2 }}</span>
        </h1>
      </div>
    </div>
  {%- endif -%}

  <div
    class="
      section
      color-{{ section.settings.color_scheme }}
      blog-posts
      spacing-style
      size-style
    "
    data-testid="blog-posts"
    style="{% render 'spacing-style', settings: section.settings %}"
  >
    {% style %}
      .blog-posts {
        --card-title-color: #000000 !important;
        --card-info-color: #000000 !important;
        --card-border-radius: {{ section.settings.card_border_radius }}px;
        --card-heading-color: #000000;
      }

      .blog-post-card__content a,
      .blog-post-card__content h1,
      .blog-post-card__content h2,
      .blog-post-card__content h3,
      .blog-post-card__content h4,
      .blog-post-card__content h5,
      .blog-post-card__content h6,
      .blog-post-card__content .text-block,
      .blog-post-card__content .text-block a,
      .blog-post-details,
      .blog-post-details__author,
      .blog-post-details__date,
      .blog-post-details__separator,
      .blog-post-details__text {
        color: #000000 !important;
        font-weight: 100 !important;
        text-align: center !important;
      }
    {% endstyle %}

    <div
      ref="grid"
      class="blog-posts-container"
    >
      {% for article in blog.articles %}
        <div
          class="blog-post-item"
          data-testid="blog-post-item"
          data-blog-index="{{ section.id }}-{{ forloop.index }}"
        >
          {% liquid
            assign featured_block = null
            for block in section.blocks
              if block.type == 'featured-post' and block.settings.article == article.handle
                assign featured_block = block
                break
              endif
            endfor
          %}
          {% if featured_block != null %}
            {% render 'blog-post-highlights', block: featured_block, article: article %}
          {% else %}
            <div class="blog-post-card">
              <a href="{{ article.url }}" class="blog-post-card__link">
                {% if article.image %}
                  <div class="blog-post-card__image-wrapper">
                    {{ article.image | image_url: width: 600 | image_tag: loading: 'lazy', class: 'blog-post-card__image' }}
                  </div>
                {% endif %}
                <div class="blog-post-card__content">
                  <h3 class="blog-post-card__title">{{ article.title }}</h3>
                  <div class="blog-post-details">
                    <span class="blog-post-details__date">{{ article.published_at | date: "%B %d, %Y" }}</span>
                  </div>
                  {% if article.excerpt %}
                    <p class="blog-post-card__excerpt">{{ article.excerpt | truncate: 150 }}</p>
                  {% endif %}
                </div>
              </a>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</blog-posts-list>

{% stylesheet %}
/**
 * Blog posts page layout
 */
.blog-posts {
  --page-content-width: var(--narrow-page-width);
  --page-width: calc(var(--page-content-width) + (var(--page-margin) * 2));
  --columns-gap: 36px;
  --rows-gap: 48px;
}

.blog-hero {
  position: relative;
  background-color: var(--hero-bg-color);
  min-height: var(--hero-min-height);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: var(--hero-text-color);
  overflow: hidden;
  margin-bottom: 2rem;
}

.blog-hero__image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
  opacity: 0.8;
}

.blog-hero__content {
  position: relative;
  z-index: 2;
  padding: 4rem 2rem;
}

.blog-hero__title {
  margin: 0;
  font-size: clamp(2.5rem, 8vw, 5rem);
  line-height: 1.1;
  color: inherit;
  font-weight: 700;
}

.blog-hero__title-main {
  display: block;
  margin-bottom: 0.5rem;
}

.blog-hero__title-italic {
  display: block;
  font-style: italic;
  font-weight: 400;
  font-size: 1.1em;
}

@media screen and (max-width: 749px) {
  .blog-hero {
    min-height: 250px;
  }
  .blog-hero__content {
    padding: 3rem 1.5rem;
  }
}

.blog-posts-container {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 1rem;
  width: 100%;
  column-gap: var(--columns-gap);
  row-gap: var(--rows-gap);
}

.blog-post-item {
  grid-column: span var(--col-span);
  border: none;
  padding: 0;
}

/* Blog post card styles */
.blog-post-card {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.blog-post-card__link {
  text-decoration: none;
  color: inherit;
  display: flex;
  flex-direction: column;
  height: 100%;
}

.blog-post-card__image-wrapper {
  position: relative;
  overflow: hidden;
  border-radius: var(--card-border-radius);
  aspect-ratio: 4/3;
}

.blog-post-card__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.blog-post-card__link:hover .blog-post-card__image {
  transform: scale(1.05);
}

.blog-post-card__content {
  padding: 1.5rem 0;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.blog-post-card__title {
  font-size: 1.25rem;
  font-weight: 600;
  margin: 0 0 0.5rem 0;
  color: var(--card-heading-color);
  line-height: 1.3;
}

.blog-post-details {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
  font-size: 0.875rem;
  color: var(--card-info-color);
}

.blog-post-card__excerpt {
  font-size: 0.9375rem;
  line-height: 1.5;
  color: var(--card-info-color);
  margin: 0;
}
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.blog_posts",
  "blocks": [
    {
      "type": "featured-post",
      "name": "Featured Post",
      "settings": [
        {
          "type": "article",
          "id": "article",
          "label": "Article"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header"]
  },
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Blog Hero Settings"
    },
    {
      "type": "checkbox",
      "id": "show_hero",
      "label": "Show Blog Hero",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero Image"
    },
    {
      "type": "color",
      "id": "hero_bg_color",
      "label": "Hero Background Color",
      "default": "#FF6B3B"
    },
    {
      "type": "color",
      "id": "hero_text_color",
      "label": "Hero Text Color",
      "default": "#FFFFFF"
    },
    {
      "type": "text",
      "id": "hero_text_1",
      "label": "Main Heading Text",
      "default": "Never miss a beat with our latest"
    },
    {
      "type": "text",
      "id": "hero_text_2",
      "label": "Sub Heading Text (Italic)",
      "default": "news"
    },
    {
      "type": "range",
      "id": "hero_height",
      "label": "Hero Min Height",
      "min": 200,
      "max": 600,
      "step": 10,
      "unit": "px",
      "default": 400
    },
    {
      "type": "header",
      "content": "Blog Card Design"
    },
    {
      "type": "color",
      "id": "card_heading_color",
      "label": "Card Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_title_color",
      "label": "Card Title Color",
      "default": "#222222"
    },
    {
      "type": "color",
      "id": "card_info_color",
      "label": "Card Info Text Color",
      "default": "#666666"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Image Border Radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 8
    }
  ]
}
{% endschema %}
